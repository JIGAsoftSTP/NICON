<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <h:head>
        <h:outputStylesheet library="Styles" name="geralSeguros.css"></h:outputStylesheet>
        <h:outputStylesheet library="Styles" name="payment.css"></h:outputStylesheet>
        <h:outputScript library="js" name="Pagamento.js" />

    </h:head>

    <h:body>
        <div class="pgtos_rcbtos ">
            <section class="payments">
                <div class="header-pgto-rcbto">
                    <h1>Pagamentos</h1>
                    <i class="icon-enlarge max-mini"></i>
                </div>
                <div class="to-minimize">
                    <h:form id="recebimentoForm">
                        <p:idleMonitor timeout="20000">
                            <p:ajax event="active" listener="#{contabilidade.loadAllPayments()}"    />
                        </p:idleMonitor>
                        <p:growl id="pagamentoGrowl" showDetail="false" />
                        <input type="checkbox" id="show-hide-new-payment" class="newPaymentCheckBox" />
                        <div  class="header-pgto-rcbto">
                            <label for="show-hide-new-payment" class="show-new-pgto-rcbto novoPagamento">Novo pagamento</label>

                            <div class="search_pgto_rcbto">
                                <h:inputText value="#{contabilidade.pesquisaPagamento}"  id="valorPesquisaPagamento" >
                                    <p:ajax event="keyup"
                                            process="@this" listener="#{contabilidade.pesquisarPagamento()}" />
                                </h:inputText>
                                <h:outputLabel class="icon-search">
                                    <p:ajax event="click"  onstart="$('.modalProcess').show()" oncomplete="$('.modalProcess').hide()" 
                                            process="@this valorPesquisaPagamento" listener="#{contabilidade.pesquisarPagamento()}" />
                                </h:outputLabel>
                            </div>
                        </div>
                        <div class="filter-table">
                            <h:outputLabel  value="Anulados" >
                                <p:ajax process="@this" event="click" listener="#{contabilidade.filtrarPagamento('anulados')}" />
                            </h:outputLabel>
                            <h:outputLabel  value="Todos" class="active">
                                <p:ajax process="@this" event="click" listener="#{contabilidade.filtrarPagamento('todos')}" />
                            </h:outputLabel>
                        </div>
                        <p:dataTable   value="#{contabilidade.listaPagamentos}" var="paga" rowKey="#{paga}" selectionMode="single"
                                       scrollable="true" selection="#{contabilidade.pagamentoSelecionado}" class="show-hide-pgto-rcbto table-payments" id="paymentTable"
                                       scrollHeight="370"             
                                       emptyMessage="Nenhum registro de pagamento encontrado">
                            <p:ajax event="rowDblselect" process="@this"
                                    listener="#{contabilidade.moreInfoPayment()}" oncomplete="showInfo(xhr, status, args)" />
                            <p:column headerText="Código" width="50">
                                #{paga.idPagamento}
                            </p:column>

                            <p:column headerText="Tipo Pagamento" width="90">
                                #{paga.tipoPagamento}
                            </p:column>
                            <p:column headerText="Conta Banco" width="80">
                                #{paga.contaBanco}
                            </p:column>
                            <p:column headerText="Valor" width="100">
                                #{paga.valor}
                            </p:column>
                            <p:column width="80">
                                <h:outputLabel class="actionTable icon-printer" title="Impressão">
                                    <p:ajax event="click" listener="#{contabilidade.impressaoPagamento(paga)}"
                                            onstart="$('.modalProcess').show()" oncomplete="$('.modalProcess').hide(),impressao(xhr, status, args)" />
                                </h:outputLabel>
                                <h:outputLabel class="actionTable icon-info" title="Mais Informações" >
                                    <p:ajax event="click" listener="#{contabilidade.infoPayment(paga)}" />
                                </h:outputLabel>
                                <h:outputLabel class="actionTable icon-cross" title="Anular Pagamento">
                                    <p:ajax event="click" listener="#{contabilidade.pagamentoS(paga)}"
                                            oncomplete="$('.anularPagamento').fadeIn()" />
                                </h:outputLabel>
                            </p:column>
                        </p:dataTable>

                        <div class="modalPage mp-infoTable modalInfoPayment">
                            <div class="modalFrame">                                            
                                <div class="modalContainer">
                                    <p><b>Informações sobre Pagamento</b></p>
                                    <p><h:outputLabel value="Código:" class="negrito" />     
                                        <h:outputText class="maisInfo infoPagamentoCodigo" style="margin-left: 2px;" /></p>   
                                    <p>
                                        <h:outputLabel value="Conta de Banco:" class="negrito" />   <h:outputText  class="maisInfo infoPagamentoContaBanco" style="margin-left: 2px;"  />
                                    </p>   
                                    <p>
                                        <h:outputLabel value="Valor:" class="negrito" />   <h:outputText  class="maisInfo infoPagamentoValor" style="margin-left: 2px;" />
                                    </p>   
                                    <p>
                                        <h:outputLabel value="Pagamento:" class="negrito" />   <h:outputText  class="maisInfo infoPagamentoPagamento" style="margin-left: 2px;" />
                                    </p>   
                                    <p>
                                        <h:outputLabel value="Modo de Pagamento:" class="negrito" />   <h:outputText  class="maisInfo infoPagamentoTipoPagamento" style="margin-left: 2px;" />
                                    </p>   
                                    <p>
                                        <h:outputLabel value="Data de Registro:" class="negrito" />   <h:outputText class="maisInfo infoPagamentoDataRegistro" style="margin-left: 2px;" />
                                    </p>   
                                    <div class="closeModalFrame moreData" >X</div>
                                </div>
                            </div>
                        </div>
                        <div class="more-info-pgto">
                            <div class="MI-pgto">
                                <h4>Informações sobre pagamento</h4>
                                <i class="icon-circle-down  SH-pgto-rcbto pagamentoINFO"></i>
                            </div><br></br>
                            <p> 
                                <h:outputLabel value="Código:" class="addPayment" /> <h:outputText class="maisInfo infoReceivent" id="payMoreInfoCodigo" value="#{contabilidade.pagamentoSelecionado.codigo}"  />
                            </p>   
                            <p>
                                <h:outputLabel value="Conta de Banco:" class="addPayment" /> <h:outputText class="maisInfo infoReceivent" id="payMoreInfoContaBanco"  value="#{contabilidade.pagamentoSelecionado.contaBanco}"  />
                            </p>   
                            <p>
                                <h:outputLabel value="Valor:" class="addPayment" /> <h:outputText id="payMoreInfoValor" class="maisInfo infoReceivent" value="#{contabilidade.pagamentoSelecionado.valor}"   />
                            </p>   
                            <p>
                                <h:outputLabel value="Pagamento:" class="addPayment" /> <h:outputText  class="maisInfo infoReceivent" id="payMoreInfoPagamento" value="#{contabilidade.pagamentoSelecionado.pagamento}" />
                            </p>   
                            <p>
                                <h:outputLabel value="Modo de Pagamento:" class="addPayment" /> <h:outputText  id="payMoreInfoModoPagamento" class="maisInfo infoReceivent" value="#{contabilidade.pagamentoSelecionado.tipoPagamento}" />
                            </p> 
                            <p>
                                <h:outputLabel value="Data de Registro:" class="addPayment" /> <h:outputText  id="payMoreInfoDataRegistro" class="maisInfo infoReceivent" value="#{contabilidade.pagamentoSelecionado.dataRegistro}" />
                            </p> 
                            <p>
                                <h:outputLabel value="Estado" class="addPayment" /> <h:outputText  id="payMoreInfoEstado" class="maisInfo infoReceivent" value="#{contabilidade.pagamentoSelecionado.estado}" />
                            </p> 
                        </div>
                        <div class="modalPage mp-messages">
                            <div class="modalFrame">                                            
                                <div class="modalContainer">
                                    <h3><h:outputText value="Novo Pagamento" class="titulo"></h:outputText></h3>
                                    <p>
                                        <h:outputText value="Pagamento efetuado com sucesso!" class="mensagemApresentada"></h:outputText>
                                    </p>
                                    <div class="divButtons">
                                        <h:commandButton class="mf-bt-ok pagamentoFechar" value="Fechar" >
                                            <p:ajax />
                                        </h:commandButton>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="newPayment formularioSeguro">
                            <div class="details-1 formatInput">


                                <nav class="navOne input-total">                                
                                    <h2><b>+</b> Novo pagamento</h2>
                                    <label for="show-hide-new-payment" class="hide-new-payment" title="Fechar"><i class="icon-arrow-left2"></i></label>
                                </nav>  

                                
                                <nav class="navTwo input-total">
                                    <p class="input-2 firstP">
                                        <h:selectOneMenu  class="total tipoPagamento" id="select-payment-type" value="#{contabilidade.pagamento.tipoPagamento}">
                                            <f:selectItems value="#{contabilidade.tipoPagamento}" var="tipo" itemLabel="#{tipo.value}" itemValue="#{tipo.id}" />
                                            <p:ajax event="change" listener="#{contabilidade.contaCarregar()}"  process="@this"/>
                                        </h:selectOneMenu>
                                        <label class="arrowSelect"></label>
                                    </p>
                                    <p class="input-2">
                                        Nº lançamento: <b> <h:outputLabel value="#{contabilidade.pagamento.idPagamento}" id="numeroPagamento"/></b>
                                    </p>

                               </nav>

                                <nav class="input-2">
                                    Nº documento <h:inputText class="input-total pagamentoNumDoc pagamentoLimparTabela pagamentoLimpar"
                                                              id="paymentNumDoc" value="#{contabilidade.pagamento.numDoc}"/>
                                </nav>
                                <nav class="input-2">
                                    Beneficiário <h:inputText class="input-total pagamentoBeneficiario pagamentoLimparTabela pagamentoLimpar" 
                                                              id="beneficiarioPagamento" value="#{contabilidade.pagamento.beneficiario}"/>
                                </nav>
                                <p>
                                <article class="areaChecks div-tgl">
                                    Retenção da Fonte 
                                    <h:selectBooleanCheckbox id="pay-rentfonte" class="pay-rentfonte" value="#{contabilidade.pagamento.hasRetencion}" >
                                        <p:ajax process="@this" />
                                    </h:selectBooleanCheckbox>
                                    <label for="recebimentoForm:pay-rentfonte"></label>
                                </article>
                                    
                               </p>
                                
                                <nav class="input-2 account-payment">
                                    Conta <!--a Debitar/Creditar-->
                                    <span  class="input-total">
                                        <p:autoComplete class="input-2-2 numeroInterio pagamentoContaPagamento" 
                                                        value="#{contabilidade.pagamento.contaPagamento}" var="listaContas"
                                                        itemLabel="#{listaContas}" itemValue="#{listaContas}"  maxResults="12"
                                                        id="pagamentoContaPgto" completeMethod="#{contabilidade.completarListaConta}">  
                                            <p:ajax event="keyup" process="@this" listener="#{contabilidade.accountInfo()}"  />
                                        </p:autoComplete>
                                        <i class="icon-info" id="info-account-payment">
                                        </i>
                                        <section>
                                            <h:outputText value="#{contabilidade.infoAccount}" id="infoAccount">

                                            </h:outputText>
                                        </section>
                                    </span>
                                </nav>
                                <div class="modalPage mp-infoTable maisInfoPagamentoTabela">
                                    <div class="modalFrame">                                            
                                        <div class="modalContainer">
                                            <p><b>Mais Informações</b></p>
                                            <p> 
                                                Nº documento: <h:outputText class="maisInfo numeroDocPagamento"  /></p>   
                                            <p>
                                                Beneficiário: <h:outputText class="maisInfo benefagamento"  />
                                            </p>   
                                            <p>
                                                Conta de Pagamento: <h:outputText  class="maisInfo contaPayment"    />
                                            </p>   
                                            <p>
                                                Valor: <h:outputText  class="maisInfo valorPagamento" />
                                            </p>  
                                            <p>
                                                Retensao: <h:outputText  class="maisInfo retensaoView" />
                                            </p>
                                            <p>
                                                Descrição de Pagamento: <h:outputText class="maisInfo descPagamento"  />
                                            </p> 
                                            <div class="closeModalFrame moreData" >X</div>
                                        </div>
                                    </div>
                                </div>

                                <p:remoteCommand actionListener="#{contabilidade.pagamentoAdicionarTabela()}"
                                                 name="pagamentoInfoTable" />
                                <nav class="input-2">
                                    Valor <h:inputText class="input-total pagamentoValor pagamentoLimparTabela pagamentoLimpar formatValue double"
                                                       id="paymentValue" value="#{contabilidade.pagamento.valor}">

                                    </h:inputText>
                                </nav>
                                <nav class="input-total">
                                    Descrição do pgto. <h:inputTextarea class="input-total pagamentoDesc pagamentoLimparTabela pagamentoLimpar"
                                                                        id="paymentDesc" value="#{contabilidade.pagamento.descricaoPagamento}"/>
                                </nav>
                                <input type="checkbox" id="check-table-details-1"  class="pagamentoCheckBox"/>
                                <div class="finish-pgto-rcbto">
                                    <h:commandButton value="Adicionar"  class="addItemTable paymentAddTable" >
                                    </h:commandButton>
                                    <label class="icon-circle-up show-hide-table" for="check-table-details-1"/>
                                </div>
                                <div id="div-table-details-1" class="paymentTableAdd">
                                    <label class="icon-circle-down show-hide-table hide-table" for="check-table-details-1"></label>
                                    <p:dataTable  value="#{contabilidade.dadosPagamento}" var="payment" selectionMode="single" rowKey="#{payment}"
                                                  scrollable="true" selection="#{contabilidade.pagamentoSelecionado}" id="pagamentoTabela"
                                                  scrollHeight="190"             
                                                  emptyMessage="Nenhum item adicionado">

                                        <p:ajax process="@this" event="rowSelect" />
                                        <p:column headerText="Nº Doc" width="50">
                                            #{payment.numDoc}
                                        </p:column>

                                        <p:column headerText="Valor" width="100">
                                            #{payment.valorFormatado}
                                        </p:column>
<!--                                        <p:column headerText="Tipo Operação" width="100">
                                            {payment.tyOperationDesc}
                                        </p:column>-->
                                        <p:column headerText="Rentensao" width="100">
                                            #{(payment.hasRetencion) ? "Sim" : "Nao" }
                                        </p:column>
                                        <p:column headerText="Ações" width="100">

                                            <h:outputLabel class="actionTable icon-cross" title="Remover linha">
                                                <p:ajax event="click" process="@this" listener="#{contabilidade.removerRegistroPagamento(payment)}" />
                                            </h:outputLabel>
                                            <h:outputLabel class="actionTable icon-bin" title="Limpar tabela">
                                                <p:ajax event="click" process="@this" listener="#{contabilidade.removeAllDataPayment()}" />
                                            </h:outputLabel>
                                            <h:outputLabel class="actionTable icon-info" title="Mais informações" >
                                                <p:ajax event="click" listener="#{contabilidade.paymentMoreInfo(payment)}"
                                                        onstart="$('.modalProcess').show()" oncomplete="$('.modalProcess').hide(),$('.maisInfoPagamentoTabela').fadeIn()" />
                                            </h:outputLabel>
                                            <h:outputLabel class="actionTable icon-pencil" title="Editar">
                                                <p:ajax  process="@this" event="click" listener="#{contabilidade.editarPagamento(payment)}"
                                                    onstart="$('.modalProcess').show()"  oncomplete="$('.modalProcess').hide()" />
                                        </h:outputLabel>
                                        </p:column>
                                    </p:dataTable>    
                                </div>
                            </div>
                            <p:remoteCommand name="regPagamento" actionListener="#{contabilidade.registrarPagamento()}" />
                            <div class="details-2 formatInput">
                                <nav class="input-total">
                                    <b>Valor total: <h:outputLabel value="#{contabilidade.pagamento.valorTotalFormatado}" id="pagamentoValorTotal" class="totalPagamento" /> </b>
                                </nav>
                                <nav class="input-2">
                                    <p>Conta </p>
                                    <h:selectOneMenu class="input-total pagamentoContaBanco pagamentoLimpar" id="tipoContaBanco" value="#{contabilidade.pagamento.contaBanco}" >
                                        <f:selectItem itemLabel="(Selecione)" />
                                        <f:selectItems value="#{contabilidade.contasBanco}" 
                                                       var="contas" itemLabel="#{contas.value}" itemValue="#{contas.id}" />
                                        <p:ajax event="change"  process="@this tipoContaBanco" listener="#{contabilidade.carregarCheque()}" />
                                    </h:selectOneMenu>
                                </nav>
                                <nav class="input-2">
                                    <p>Data </p>
                                    <p:calendar  class="input-total dataPagamento" id="pagamentoData" pattern="dd-MM-yyyy"></p:calendar>
                                </nav>
                                <nav class="input-2">
                                    Forma de pgto.
                                    <h:selectOneMenu class="input-total pagamentoForma pagamentoLimpar" value="#{contabilidade.pagamento.formaPagamento}">
                                        <f:selectItem itemLabel="(Selecione)" />
                                        <f:selectItems value="#{contabilidade.formaPagamento}"
                                                       var="formaP" itemLabel="#{formaP.value}" itemValue="#{formaP.id}" />
                                        <p:ajax event="change"  process="@this tipoContaBanco" listener="#{contabilidade.carregarCheque()}" />
                                    </h:selectOneMenu>
                                </nav>
                                <nav class="input-2">
                                    Número <h:inputText class="input-total pagamentoNumero numeroInterio pagamentoLimpar"
                                                        value="#{contabilidade.pagamento.numero}"  id="pagamentoNumeroCarregar"/>
                                </nav>
                                <div class="finish-pgto-rcbto">
                                    <h:commandButton value="Concluir pagamento" class="finishPayment">
                                        <p:ajax  process="recebimentoForm" />
                                    </h:commandButton>
                                </div>
                            </div>

                        </div>
                    </h:form>
                </div>
            </section>




            <section class="receivents">
                <div class="header-pgto-rcbto">
                    <h1>Recebimentos</h1>
                    <i class="icon-enlarge max-mini"></i>
                </div>
                <div class="to-minimize">

                    <div class="modalPage mp-infoTable modalInfoRecebimento">
                        <div class="modalFrame">                                            
                            <div class="modalContainer">
                                <p><b>Informações sobre Recebimento</b></p>
                                <p><h:outputLabel value="Número:" class="negrito" />     
                                    <h:outputText class="maisInfo infoRecebimentoNumero" style="margin-left: 2px;" /></p>   
                                <p>
                                    <h:outputLabel value="Cliente:" class="negrito" />   <h:outputText  class="maisInfo infoRecebimentoCliente" style="margin-left: 2px;"  />
                                </p>   
                                <p>
                                    <h:outputLabel value="Apolice:" class="negrito" />   <h:outputText  class="maisInfo infoRecebimentoApolice" style="margin-left: 2px;" />
                                </p>   
                                <p>
                                    <h:outputLabel value="Seguro:" class="negrito" />   <h:outputText  class="maisInfo infoRecebimentoSeguro" style="margin-left: 2px;" />
                                </p>   
                                <p>
                                    <h:outputLabel value="Valor a Pagar:" class="negrito" />   <h:outputText  class="maisInfo infoRecebimentoValorPagar" style="margin-left: 2px;" />
                                </p>   
                                <p>
                                    <h:outputLabel value="Valor Pago:" class="negrito" />   <h:outputText class="maisInfo infoRecebimentoValorPago" style="margin-left: 2px;" />
                                </p>   
                                <p>
                                    <h:outputLabel value="Moeda:" class="negrito" />   <h:outputText class="maisInfo infoRecebimentoMoeda" style="margin-left: 2px;" />
                                </p>   
                                <p>
                                    <h:outputLabel value="Estado:" class="negrito" />   <h:outputText class="maisInfo infoRecebimentoEstado" style="margin-left: 2px;" />
                                </p>   
                                <div class="closeModalFrame moreData" >X</div>
                            </div>
                        </div>
                    </div>
                    <h:form id="recebimentoFormTabela">

                        <p:growl id="growlPrestacao" showDetail="false" life="10000" />
                        <p:idleMonitor timeout="2000" >
                            <p:ajax event="active"  listener="#{contabilidade.loadContractNoPay()}"  />
                        </p:idleMonitor>
                        <input type="checkbox" id="show-hide-new-receivent" class="selecionadoCheckBox"/>
                        <div  class="header-pgto-rcbto">
                            <label></label>

                            <div class="search_pgto_rcbto">
                                <h:inputText id="valorPesquisaRecebimento" value="#{contabilidade.pesquisar}" >
                                    <p:ajax event="keyup" process="@this" 
                                            listener="#{contabilidade.pesquisarClienteRecebimento()}" />
                                </h:inputText>
                                <h:outputLabel class="icon-search">
                                    <p:ajax event="click" process="@this recebimentoFormTabela:valorPesquisaRecebimento" 
                                            listener="#{contabilidade.pesquisarClienteRecebimento()}" />
                                </h:outputLabel>
                            </div>
                        </div>
                        <div class="filter-table">
                            <h:outputLabel  value="Pagos">
                                <p:ajax process="@this" onstart="$('.modalProcess').show()" oncomplete="$('.modalProcess').hide()"
                                        event="click" listener="#{contabilidade.filtrarRecebimento('pagos')}" />
                            </h:outputLabel>
                            <h:outputLabel  value="Não Pagos" class="">
                                <p:ajax process="@this" onstart="$('.modalProcess').show()" oncomplete="$('.modalProcess').hide()"
                                        event="click" listener="#{contabilidade.filtrarRecebimento('não pagos')}" />
                            </h:outputLabel>
                            <h:outputLabel  value="Todos" class="active">
                                <p:ajax process="@this" onstart="$('.modalProcess').show()" oncomplete="$('.modalProcess').hide()"
                                        event="click" listener="#{contabilidade.filtrarRecebimento('todos')}" />
                            </h:outputLabel>
                        </div>
                        <p:dataTable  var="c" value="#{contabilidade.contratoContabilidade}" id="tabelaRecebimentoCliente"
                                      scrollable="true" rowKey="#{c}" selectionMode="single" lazy="true"
                                      selection="#{contabilidade.recebimentoSelecionado}"
                                      scrollHeight="180" class="show-hide-pgto-rcbto table-receivents"            
                                      emptyMessage="">
                            <p:ajax event="rowSelect" process="@this" listener="#{contabilidade.carregarPrestacoes()}" />
                            <p:ajax event="rowDblselect" process="@this" listener="#{contabilidade.moreInfo()}" oncomplete="showInfo(xhr, status, args)" />
                            <p:column headerText="Cliente" width="150">
                                #{c.cliente}
                            </p:column>

                            <p:column headerText="Apolice" width="100">
                                #{c.apolice}
                            </p:column>
                            <p:column headerText="Seguro" width="80">
                                #{c.codigoSeguro}
                            </p:column>
                            <p:column headerText="Valor Pagar" width="80">
                                #{c.valorPagar}
                            </p:column>  
                            <p:column width="20">
                                <h:outputLabel class="actionTable icon-info" title="Mais Informações"  >
                                    <p:ajax event="click" listener="#{contabilidade.moreInfoRecebimento(c)}" />
                                </h:outputLabel>
                            </p:column>
                        </p:dataTable>

                        <p:dataTable    class="table-2-receivents" value="#{contabilidade.prestacoes}" var="prestacao" rowKey="#{prestacao}"
                                        selection="#{contabilidade.prestacao}" selectionMode="single" 
                                        scrollable="true" id="prestacaoRecebimento"
                                        scrollHeight="130"             
                                        emptyMessage="Nenhuma prestação encontrada">
                            <p:ajax event="rowDblselect" listener="#{contabilidade.novoRecebimento()}" process="@this" update="@this"
                                    onstart="$('.modalProcess').show()" oncomplete="$('.modalProcess').hide(),impressao(xhr, status, args)"/>
                            <p:column headerText="Valor" width="50">
                                #{prestacao.valor}
                            </p:column>
                            <p:column headerText="Valor Pago" width="90">
                                #{prestacao.valorPagoPrestacao}
                            </p:column>
                            <p:column headerText="Data" width="90">
                                #{prestacao.dataRegistro}
                            </p:column>
                            <p:column headerText="Estado" width="40">
                                #{prestacao.estadoPrestacao}
                            </p:column> 
                        </p:dataTable>

                        <div class="more-info-rcbto">
                            <div class="MI-rcbto">
                                <h4>Informações sobre recebimentos</h4>
                                <i class="icon-circle-down SH-pgto-rcbto recebim"></i>
                            </div><br/>
                            <p>
                                <h:outputLabel value="Número:" class="addPayment" />  <h:outputText value="#{contabilidade.recebimentoSelecionado.id}" 
                                                                                                    class="maisInfo infoReceivent" id="numeroInfo" /></p>   
                            <p>
                                <h:outputLabel value="Cliente:" class="addPayment" />  <h:outputText value="#{contabilidade.recebimentoSelecionado.cliente}" 
                                                                                                     class="maisInfo infoReceivent" id="moreInoCliente"  />
                            </p>   
                            <p>
                                <h:outputLabel value="Apolice:" class="addPayment" /> <h:outputText  id="moreInfoApolice"
                                                                                                     value="#{contabilidade.recebimentoSelecionado.apolice}" class="maisInfo infoReceivent"  />
                            </p>  
                            <p >
                                <h:outputLabel  class="addPayment" value="Seguro:"/>  <h:outputText  id="moreInfoSeguro"
                                                                                                     value="#{contabilidade.recebimentoSelecionado.codigoSeguro}" class="maisInfo infoReceivent" />
                            </p>   
                            <p>
                                <h:outputLabel  value="Valor a Pagar:" class="addPayment" /> <h:outputText id="moreInfoValorPagar"
                                                                                                           value="#{contabilidade.recebimentoSelecionado.valorPagar}" class="maisInfo infoReceivent" />
                            </p>   
                            <p>
                                <h:outputLabel value="Valor Pago:" class="addPayment" /> <h:outputText  id="moreInfoValorPago"
                                                                                                        value="#{contabilidade.recebimentoSelecionado.valorPago}" class="maisInfo infoReceivent"  />
                            </p>   
                            <p>
                                <h:outputLabel value="Moeda:" class="addPayment" />  <h:outputText id="moreInfoMoeda"
                                                                                                   value="#{contabilidade.recebimentoSelecionado.moeda}" class="maisInfo infoReceivent"  />
                            </p>   
                            <p>
                                <h:outputLabel value="Estado:" class="addPayment" /> <h:outputText  id="moreInfoEstado"
                                                                                                    value="#{contabilidade.recebimentoSelecionado.estado}" class="maisInfo infoReceivent"  />
                            </p> 
                        </div>
                        <div class="newReceivent formularioSeguro">
                            <nav class="navOne input-total">                                
                                <h2><b>+</b> Novo Recebimento</h2>
                                <label for="show-hide-new-receivent" class="hide-new-receivent" title="Fechar"><i class="icon-arrow-right2"></i></label>
                            </nav> 
                            <div class="infoReceivent">
                                <p>
                                    <label>Apólice: </label>
                                    <h:outputText value="#{contabilidade.recebimentoSelecionado.apolice}"  id="apolicePrestacao"/>
                                </p>
                                <p>
                                    <label>Cliente: </label>
                                    <h:outputText value="#{contabilidade.recebimentoSelecionado.cliente}" id="clientePrestacao" />
                                </p>
                                <p>
                                    <label>Tipo de seguro: </label>
                                    <h:outputText value="#{contabilidade.recebimentoSelecionado.codigoSeguro}" id="seguroPrestacao" />
                                </p>
                                <p>
                                    <label>Valor: </label>
                                    <h:outputText value="#{contabilidade.prestacao.valor} #{contabilidade.recebimentoSelecionado.moeda}" id="prestacaoValor" />
                                    <h:outputText  value=" #{contabilidade.prestacao.valorSTD}" id="valorSTD"/>
                                </p>
                                <p>
                                    <label>Prestação: </label>
                                    <h:outputText id="prestacaoReceb"
                                                  value="#{contabilidade.prestacao.valorPagoPrestacao} #{contabilidade.recebimentoSelecionado.moeda}" />
                                </p>
                            </div>
                            <p:remoteCommand actionListener="#{contabilidade.descricaoConta()}" process="prestacaoConta" />
                            <div class="addPayment formatInput">
                                <nav class="input-total">
                                    Forma de pagamento
                                    <h:selectOneMenu  class="input-total prestacaoFormaPagamento prestacaoLimpar" id="prestacaoFormaPagamento"  value="#{contabilidade.prestacao.formaPagamento}">
                                        <f:selectItem itemLabel="(Selecione)" />
                                        <f:selectItems value="#{contabilidade.formaPagamento}"
                                                       var="forma" itemLabel="#{forma.value}" itemValue="#{forma.id}" />
                                    </h:selectOneMenu>
                                </nav>
                                <nav class="input-2">
                                    Nº documento
                                    <h:inputText class="input-total prestacaoNumDoc prestacaoLimpar" id="prestacaoNumDoc" value="#{contabilidade.prestacao.numDoc}"/>
                                </nav>
                                <nav class="input-2">
                                    Conta
                                    <h:selectOneMenu class="input-total prestacaoConta prestacaoLimpar" id="prestacaoConta" value="#{contabilidade.prestacao.conta}">
                                        <f:selectItem itemLabel="(Selecione)" />
                                        <f:selectItems value="#{contabilidade.contas}"
                                                       var="conta" itemLabel="#{conta.value}" itemValue="#{conta.id}" />
                                        <p:ajax event="mousemove" listener="#{contabilidade.descricaoConta()}" />
                                    </h:selectOneMenu>

                                </nav>
                            </div>
                            <div class="finish-pgto-rcbto">
                                <h:commandButton value="Concluir recebimento" class="concluirRecebimento" onclick="$('.modalProcess').show()"   type="button" action="#{contabilidade.registrarAmortizacao()}">
                                    <p:ajax  process="@this prestacaoFormaPagamento prestacaoNumDoc prestacaoConta" oncomplete="impressao(xhr, status, args)" />
                                </h:commandButton>
                            </div>
                        </div>
                    </h:form>
                </div>
            </section>
        </div>

        <h:form id="formModalAnularPagamento">
            <p:growl id="growlAnularPagamento" showDetail="false" />
            <div class="modalPage mp-messages anularPagamento">
                <div class="modalFrame">                                            
                    <div class="modalContainer">
                        <h3><h:outputText value="Anular Pagamento" class="titulo"></h:outputText></h3>
                        <p>
                            <h:outputText value="Observação"  class="conteudos" ></h:outputText>
                            <h:inputTextarea value="#{contabilidade.obs}" id="obsAnularPagamento" class="obsAnular" style="width: 100%"  required="true"/>
                        </p>
                        <div class="divButtons">
                            <h:commandButton class="mf-bt-ok anularPagamentoBotao" value="Sim" action="#{contabilidade.anularPagamento()}" >
                                <p:ajax process="@this obsAnularPagamento" oncomplete="$('.modalProcess').hide()" />
                            </h:commandButton>
                            <h:commandButton class="mf-bt-ko" value="Cancelar">
                                <p:ajax process="@none"/>
                            </h:commandButton>
                        </div>
                    </div>
                </div>
            </div>
            <div class="processamento modalProcess">
                <h:graphicImage value="/Images/earth.gif" class="imageProcess" />
            </div>
        </h:form>
        <p:socket channel="/notify" onMessage="handleMessage" >
        </p:socket>
    </h:body>
    <script>

        $('.max-mini').click(function () {
            var atual = $(this);
            var toMini = atual.parent().parent().siblings();
            var noActual = toMini.find('.max-mini');
            if (atual.hasClass('icon-enlarge')) {
                atual.removeClass('icon-enlarge').addClass('icon-shrink');
                toMini.addClass('minimize-me');
                toMini.siblings().removeClass('minimize-me');
                noActual.removeClass('icon-shrink').addClass('icon-enlarge');
            } else {
                atual.removeClass('icon-shrink').addClass('icon-enlarge');
                toMini.removeClass('minimize-me');
            }

        });


//        $('.SH-pgto-rcbto').click(function () {
//            more_info($(this));
//            
//        });
//        $('.show-hide-pgto-rcbto tr').dblclick(function () {                          
//            more_info($(this));
//
//        });
        $(".recebim").click(function ()
        {
            $('.more-info-rcbto').slideToggle(300);
        });
        $(".pagamentoINFO").click(function ()
        {
            $('.more-info-pgto').slideToggle(300);
        });

        function more_info(element)
        {
            var father = element.closest('section');
            var isPayment = father.attr('class');

            if (isPayment === 'payments')
                $('.more-info-pgto').slideToggle(300);
            else
                $('.more-info-rcbto').slideToggle(300);
        }
        function showInfo(xhr, status, args)
        {
            if (args.info === 'pagamento')
                $('.more-info-pgto').slideToggle(300);
            else
                $('.more-info-rcbto').slideToggle(300);
        }
        function impressaoRecebimento(xhr, status, args)
        {
            window.open(args.registro);
        }
        function registro(xhr, status, args)
        {
            window.open(args.registro);
        }

        function impressao(xhr, status, args)
        {
            if (args.estado === 'pago')
                window.open(args.imprimir);
        }
        $(".toggle-1 label").click(function ()
        {
            $(this).addClass('active').siblings().removeClass('active');
        });
    </script>
</html>

